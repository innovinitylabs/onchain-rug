<html><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1"><title>OnchainRug #TOKEN_ID</title><script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.7.0/p5.min.js"></script><style>body{margin:0;padding:1;display:flex;justify-content:center;align-items:center}</style></head><body><div id="canvas-container"><canvas id="defaultCanvas0" class="p5Canvas" width="3300" height="2300" style="width: 1320px; height: 920px;"></canvas></div><script>let w=800,h=1200,f=30,wt=8,wp=3,ts=2,lt,dt,p={"name":"Natural Dyes","colors":["#405BAA","#B33A3A","#D9A43B","#1F1E1D","#5A7A5A","#8C5832","#A48E7F","#FAF1E3"]},sd=[{"y":0,"height":68.19515249342658,"primaryColor":"#8C5832","secondaryColor":null,"weaveType":"solid","warpVariation":0.2523032833822072},{"y":68.19515249342658,"height":60.57278794585727,"primaryColor":"#405BAA","secondaryColor":null,"weaveType":"textured","warpVariation":0.290026696305722},{"y":128.76794043928385,"height":63.33571700495668,"primaryColor":"#5A7A5A","secondaryColor":null,"weaveType":"textured","warpVariation":0.4872925163246692},{"y":192.10365744424053,"height":53.3551848330535,"primaryColor":"#D9A43B","secondaryColor":null,"weaveType":"mixed","warpVariation":0.264055412914604},{"y":245.45884227729402,"height":26.21111069340259,"primaryColor":"#8C5832","secondaryColor":null,"weaveType":"textured","warpVariation":0.4787444246001542},{"y":271.6699529706966,"height":33.66517815273255,"primaryColor":"#A48E7F","secondaryColor":null,"weaveType":"solid","warpVariation":0.1734160046093166},{"y":305.33513112342916,"height":28.467843332327902,"primaryColor":"#405BAA","secondaryColor":null,"weaveType":"mixed","warpVariation":0.17198934191837906},{"y":333.80297445575707,"height":35.42853733757511,"primaryColor":"#D9A43B","secondaryColor":"#1F1E1D","weaveType":"solid","warpVariation":0.34202465508133173},{"y":369.2315117933322,"height":64.56409373320639,"primaryColor":"#D9A43B","secondaryColor":"#A48E7F","weaveType":"mixed","warpVariation":0.3359488218091429},{"y":433.79560552653857,"height":30.935605061240494,"primaryColor":"#8C5832","secondaryColor":"#5A7A5A","weaveType":"mixed","warpVariation":0.4187390603125095},{"y":464.73121058777906,"height":30.467415573075414,"primaryColor":"#FAF1E3","secondaryColor":"#8C5832","weaveType":"mixed","warpVariation":0.297656558919698},{"y":495.1986261608545,"height":71.31803949712776,"primaryColor":"#5A7A5A","secondaryColor":null,"weaveType":"solid","warpVariation":0.1779076951555908},{"y":566.5166656579822,"height":59.781514236237854,"primaryColor":"#FAF1E3","secondaryColor":null,"weaveType":"textured","warpVariation":0.1889693201519549},{"y":626.2981798942201,"height":58.780578861478716,"primaryColor":"#A48E7F","secondaryColor":null,"weaveType":"solid","warpVariation":0.4463496922515333},{"y":685.0787587556988,"height":61.152302387636155,"primaryColor":"#FAF1E3","secondaryColor":null,"weaveType":"solid","warpVariation":0.11557929040864111},{"y":746.231061143335,"height":41.0022804629989,"primaryColor":"#A48E7F","secondaryColor":null,"weaveType":"solid","warpVariation":0.1446685473434627},{"y":787.2333416063339,"height":26.13990316633135,"primaryColor":"#D9A43B","secondaryColor":null,"weaveType":"mixed","warpVariation":0.41371035808697343},{"y":813.3732447726652,"height":28.3406683197245,"primaryColor":"#A48E7F","secondaryColor":"#B33A3A","weaveType":"solid","warpVariation":0.3707780132070184},{"y":841.7139130923897,"height":21.8485507927835,"primaryColor":"#B33A3A","secondaryColor":null,"weaveType":"mixed","warpVariation":0.14659687876701355},{"y":863.5624638851732,"height":36.99597468134016,"primaryColor":"#B33A3A","secondaryColor":null,"weaveType":"textured","warpVariation":0.23930853065103294},{"y":900.5584385665134,"height":42.584983836859465,"primaryColor":"#8C5832","secondaryColor":null,"weaveType":"solid","warpVariation":0.1631861712783575},{"y":943.1434224033728,"height":68.52599811507389,"primaryColor":"#8C5832","secondaryColor":"#8C5832","weaveType":"mixed","warpVariation":0.1463954740203917},{"y":1011.6694205184467,"height":37.916444225702435,"primaryColor":"#8C5832","secondaryColor":"#1F1E1D","weaveType":"textured","warpVariation":0.14169594440609218},{"y":1049.5858647441491,"height":23.670224454253912,"primaryColor":"#D9A43B","secondaryColor":"#FAF1E3","weaveType":"mixed","warpVariation":0.16411913027986885},{"y":1073.256089198403,"height":78.71323970728554,"primaryColor":"#1F1E1D","secondaryColor":"#A48E7F","weaveType":"textured","warpVariation":0.17618615701794627},{"y":1151.9693289056886,"height":48.0306710943114,"primaryColor":"#405BAA","secondaryColor":"#405BAA","weaveType":"solid","warpVariation":0.3872393210418522}],tr=["WER"],td=[],dl=0,tl=0,s=12345,cm={"W":["10001","10001","10001","10001","10101","11011","10001"],"E":["11111","10000","10000","11110","10000","10000","11111"],"R":["11110","10001","10001","11110","10100","10010","10001"]," ":["00000","00000","00000","00000","00000","00000","00000"]};window.characterMap=cm;function setup(){
  try {
    console.log('üé® Setting up p5.js canvas...');
    noiseSeed(s);
    window.d=function(seed){window.prngSeed=seed%2147483647;if(window.prngSeed<=0)window.prngSeed+=2147483646};
    window.b=function(){window.prngSeed=(window.prngSeed*16807)%2147483647;return(window.prngSeed-1)/2147483646};
    window.a=function(min,max){return min+window.b()*(max-min)};
    window.c=function(array){return array[Math.floor(window.b()*array.length)]};
    window.d(s);
    let canvas=createCanvas(h+(f*4),w+(f*4));
    canvas.parent("canvas-container");
    pixelDensity(2.5);
    console.log('‚úÖ Canvas created:', canvas);
    u();
    gtd();
    noLoop();
    console.log('‚úÖ Setup complete');
  } catch(error) {
    console.error('‚ùå Setup failed:', error);
  }
}function u(){if(!p||!p.colors)return;let d=p.colors[0],l=p.colors[0],dv=999,lv=-1;for(let hex of p.colors){let c=color(hex),b=(red(c)+green(c)+blue(c))/3;if(b<dv){dv=b;d=hex}if(b>lv){lv=b;l=hex}}dt=lerpColor(color(d),color(0),0.4);lt=lerpColor(color(l),color(255),0.3)}function draw(){
  try {
    console.log('üé® Starting draw...');
    background(222,222,222);
    push();
    translate(width/2,height/2);
    rotate(PI/2);
    translate(-height/2,-width/2);
    push();
    translate(f*2,f*2);
    console.log('üìä Rendering', sd.length, 'stripes');
    for(let stripe of sd) {
      try {
        ds(stripe);
      } catch(stripeError) {
        console.error('‚ùå Error rendering stripe:', stripe, stripeError);
      }
    }
    if(tl>0) {
      try {
        dtol(Math.floor(tl));
      } catch(error) {
        console.error('‚ùå Error applying texture level:', error);
      }
    }
    pop();
    try {
      df();
    } catch(error) {
      console.error('‚ùå Error rendering frame:', error);
    }
    if(dl>0) {
      try {
        ddo(Math.floor(dl));
      } catch(error) {
        console.error('‚ùå Error applying dirt level:', error);
      }
    }
    pop();
    console.log('‚úÖ Draw complete');
  } catch(error) {
    console.error('‚ùå Draw failed:', error);
  }
}function ds(s){let ws=wp+1,we=wt+1;for(let x=0;x<w;x+=ws){for(let y=s.y;y<s.y+s.height;y+=we){let wc=color(s.primaryColor),itp=false;if(td.length>0){for(let tp of td){if(x>=tp.x&&x<tp.x+tp.width&&y>=tp.y&&y<tp.y+tp.height){itp=true;break}}}let r=red(wc)+window.a(-15,15),g=green(wc)+window.a(-15,15),b=blue(wc)+window.a(-15,15);if(itp){const bb=(r+g+b)/3;let tc=bb<128?lt:dt;r=red(tc);g=green(tc);b=blue(tc)}r=constrain(r,0,255);g=constrain(g,0,255);b=constrain(b,0,255);fill(r,g,b);noStroke();let wcv=sin(y*0.05)*0.5;rect(x+wcv,y,wp,we)}}for(let y=s.y;y<s.y+s.height;y+=we){for(let x=0;x<w;x+=ws){let wc=color(s.primaryColor),itp=false;if(td.length>0){for(let tp of td){if(x>=tp.x&&x<tp.x+tp.width&&y>=tp.y&&y<tp.y+tp.height){itp=true;break}}}if(s.weaveType==="m"&&s.secondaryColor){if(noise(x*0.1,y*0.1)>0.5)wc=color(s.secondaryColor)}else if(s.weaveType==="t"){let nv=noise(x*0.05,y*0.05);wc=lerpColor(color(s.primaryColor),color(255),nv*0.15)}let r=red(wc)+window.a(-20,20),g=green(wc)+window.a(-20,20),b=blue(wc)+window.a(-20,20);if(itp){const bb=(r+g+b)/3;let tc=bb<128?lt:dt;r=red(tc);g=green(tc);b=blue(tc)}r=constrain(r,0,255);g=constrain(g,0,255);b=constrain(b,0,255);fill(r,g,b);noStroke();let wcv=cos(x*0.05)*0.5;rect(x,y+wcv,ws,wt)}}for(let y=s.y;y<s.y+s.height;y+=we*2){for(let x=0;x<w;x+=ws*2){fill(0,0,0,40);noStroke();rect(x+1,y+1,ws-2,we-2)}}for(let y=s.y+we;y<s.y+s.height;y+=we*2){for(let x=ws;x<w;x+=ws*2){fill(255,255,255,30);noStroke();rect(x,y,ws-1,we-1)}}}function dto(){push();blendMode(MULTIPLY);for(let x=0;x<w;x+=2){for(let y=0;y<h;y+=2){let nv=noise(x*0.02,y*0.02),a=map(nv,0,1,0,50);fill(0,0,0,a);noStroke();rect(x,y,2,2)}}for(let x=0;x<w;x+=6){for(let y=0;y<h;y+=6){let nv=noise(x*0.03,y*0.03);if(nv>0.6){fill(255,255,255,25);noStroke();rect(x,y,6,6)}else if(nv<0.4){fill(0,0,0,20);noStroke();rect(x,y,6,6)}}}pop()}function dtol(tl){const hi=tl===1?30:80,ri=tl===1?20:40,rt=tl===1?0.6:0.5;push();blendMode(MULTIPLY);for(let x=0;x<w;x+=2){for(let y=0;y<h;y+=2){let nv=noise(x*0.02,y*0.02),i=map(nv,0,1,0,hi);fill(0,0,0,i);noStroke();rect(x,y,2,2)}}for(let x=0;x<w;x+=6){for(let y=0;y<h;y+=6){let rn=noise(x*0.03,y*0.03);if(rn>rt){fill(255,255,255,ri);noStroke();rect(x,y,6,6)}else if(rn<(1-rt)){fill(0,0,0,ri*0.8);noStroke();rect(x,y,6,6)}}}if(tl===2){for(let x=0;x<w;x+=8){for(let y=0;y<h;y+=8){let wn=noise(x*0.01,y*0.01);if(wn>0.7){fill(0,0,0,15);noStroke();rect(x,y,8,2)}}}}pop()}function ddo(dl){const di=dl===1?0.5:1.0,doo=dl===1?30:60;push();translate(f*2,f*2);for(let x=0;x<w;x+=3){for(let y=0;y<h;y+=3){const dn=window.a(0,1),dt=0.85*di;if(dn>dt){const ds=window.a(1,4),da=window.a(doo*0.5,doo),dr=window.a(60,90),dg=window.a(40,60),db=window.a(20,40);fill(dr,dg,db,da);noStroke();ellipse(x,y,ds,ds)}}}for(let i=0;i<15*di;i++){const sx=window.a(0,w),sy=window.a(0,h),ss=window.a(8,20),sa=window.a(doo*0.3,doo*0.7),sr=window.a(40,70),sg=window.a(25,45),sb=window.a(15,30);fill(sr,sg,sb,sa);noStroke();ellipse(sx,sy,ss,ss)}for(let x=0;x<w;x+=2){for(let y=0;y<h;y+=2){const ed=Math.min(x,y,w-x,h-y);if(ed<10){const edirt=window.a(0,1);if(edirt>0.7*di){const ea=window.a(10,25);fill(80,50,20,ea);noStroke();rect(x,y,2,2)}}}}pop()}function df(){dfs(f*2,f,w,f,"top");dfs(f*2,f*2+h,w,f,"bottom");dse()}function dfs(x,y,w,h,side){let fs=w/12,sw=w/fs;for(let i=0;i<fs;i++){let sx=x+i*sw;if(!p||!p.colors)return;let sc=window.c(p.colors);for(let j=0;j<12;j++){let tx=sx+window.a(-sw/6,sw/6),sy=side==="top"?y+h:y,ey=side==="top"?y:y+h,wa=window.a(1,4),wf=window.a(0.2,0.8),d=window.c([-1,1]),ci=window.a(0.5,2.0),tl=window.a(0.8,1.2),fc=color(sc),r=red(fc)*0.7,g=green(fc)*0.7,b=blue(fc)*0.7;stroke(r,g,b);strokeWeight(window.a(0.5,1.2));noFill();beginShape();for(let t=0;t<=1;t+=0.1){let yp=lerp(sy,ey,t*tl),xo=sin(t*PI*wf)*wa*t*d*ci;xo+=window.a(-1,1);if(window.b()<0.3)xo+=window.a(-2,2);vertex(tx+xo,yp)}endShape()}}}function dse(){let ws=wt+1,iff=true,il=false;for(let s of sd){for(let y=s.y;y<s.y+s.height;y+=ws){if(iff){iff=false;continue}if(s===sd[sd.length-1]&&y+ws>=s.y+s.height){il=true;continue}let sc=color(s.primaryColor);if(s.secondaryColor&&s.weaveType==="m"){let sc2=color(s.secondaryColor),bf=noise(y*0.1)*0.5+0.5;sc=lerpColor(sc,sc2,bf)}let r=red(sc)*0.8,g=green(sc)*0.8,b=blue(sc)*0.8;fill(r,g,b);noStroke();let rad=wt*window.a(1.2,1.8),cx=f*2+window.a(-2,2),cy=f*2+y+wt/2+window.a(-1,1),sa=HALF_PI+window.a(-0.2,0.2),ea=-HALF_PI+window.a(-0.2,0.2);dtsa(cx,cy,rad,sa,ea,r,g,b,"left")}}let ifwr=true,ilwr=false;for(let s of sd){for(let y=s.y;y<s.y+s.height;y+=ws){if(ifwr){ifwr=false;continue}if(s===sd[sd.length-1]&&y+ws>=s.y+s.height){ilwr=true;continue}let sc=color(s.primaryColor);if(s.secondaryColor&&s.weaveType==="m"){let sc2=color(s.secondaryColor),bf=noise(y*0.1)*0.5+0.5;sc=lerpColor(sc,sc2,bf)}let r=red(sc)*0.8,g=green(sc)*0.8,b=blue(sc)*0.8;fill(r,g,b);noStroke();let rad=wt*window.a(1.2,1.8),cx=f*2+w+window.a(-2,2),cy=f*2+y+wt/2+window.a(-1,1),sa=-HALF_PI+window.a(-0.2,0.2),ea=HALF_PI+window.a(-0.2,0.2);dtsa(cx,cy,rad,sa,ea,r,g,b,"right")}}}function dtsa(cx,cy,rad,sa,ea,r,g,b,s){let tc=max(6,floor(rad/1.2)),ts=rad/tc;for(let i=0;i<tc;i++){let tr=rad-(i*ts),trr,trg,tb;if(i%2===0){trr=constrain(r+25,0,255);trg=constrain(g+25,0,255);tb=constrain(b+25,0,255)}else{trr=constrain(r-20,0,255);trg=constrain(g-20,0,255);tb=constrain(b-20,0,255)}trr=constrain(trr+window.a(-10,10),0,255);trg=constrain(trg+window.a(-10,10),0,255);tb=constrain(tb+window.a(-10,10),0,255);fill(trr,trg,tb,88);let tx=cx+window.a(-1,1),ty=cy+window.a(-1,1),tsa=sa+window.a(-0.1,0.1),tea=ea+window.a(-0.1,0.1);arc(tx,ty,tr*2,tr*2,tsa,tea)}for(let i=0;i<3;i++){let dr=rad*(0.3+i*0.2),da=180-(i*40),drr=constrain(r+(i%2===0?15:-15),0,255),dg=constrain(g+(i%2===0?15:-15),0,255),db=constrain(b+(i%2===0?15:-15),0,255);fill(drr,dg,db,da*0.7);let dx=cx+window.a(-0.5,0.5),dy=cy+window.a(-0.5,0.5),dsa=sa+window.a(-0.05,0.05),dea=ea+window.a(-0.05,0.05);arc(dx,dy,dr*2,dr*2,dsa,dea)}fill(r*0.6,g*0.6,b*0.6,70);let so=s==="left"?1:-1;arc(cx+so,cy+1,rad*2,rad*2,sa,ea);noFill();arc(cx,cy,rad*0.5,rad*0.5,sa,ea);for(let i=0;i<8;i++){let da=window.a(sa,ea),dr=rad*window.a(0.2,0.7),dx=cx+cos(da)*dr,dy=cy+sin(da)*dr;if(i%2===0){fill(r+20,g+20,b+20,120)}else{fill(r-15,g-15,b-15,120)}noStroke();ellipse(dx,dy,window.a(1.5,3.5),window.a(1.5,3.5))}}function gtd(){td=[];const trr=tr||[];if(!trr||trr.length===0)return;const netr=trr.filter(row=>row&&row.trim()!=="");if(netr.length===0)return;const ws=wp+1,we=wt+1,sw=ws*ts,se=we*ts,cw=7*sw,ch=5*se,s=se,rs=cw*1.5,trw=netr.length*cw+(netr.length-1)*rs,bsx=(w-trw)/2;let cri=0;for(let ri=0;ri<trr.length;ri++){const rt=trr[ri];if(!rt||rt.trim()==="")continue;const tw=cw,th=rt.length*(ch+s)-s,sx=bsx+cri*(cw+rs),sy=(h-th)/2;for(let i=0;i<rt.length;i++){const c=rt.charAt(i),cy=sy+(rt.length-1-i)*(ch+s),cp=gcp(c,sx,cy,tw,ch);td.push(...cp)}cri++}}function gcp(c,x,y,w,h){const p=[];const ws=wp+1,we=wt+1,sw=ws*ts,se=we*ts,cd=cm[c.toUpperCase()]||cm[" "],nr=cd.length,nc=cd[0].length;for(let r=0;r<nr;r++){for(let col=0;col<nc;col++){if(cd[r][col]==="1"){const ncol=r,nrow=nc-1-col;p.push({x:x+ncol*sw,y:y+nrow*se,width:sw,height:se})}}}return p}</script><main></main></body></html>